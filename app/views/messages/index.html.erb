<% if @messages.any? %>
  <%= link_to "Delete all messages", destroy_all_messages_path, method: "post", class: "btn blue right", data: {confirm: "Delete all of your messages forever?"} %>
<% end %>
<%= link_to "Create new message", new_message_path, class: "btn blue right" %>
<br>
<h2>
  <% if Message.where(user_target_id: current_user.id).any? %>
    Your private messages:
  <% else %>
    You have no private messages.
  <% end %>
</h2>

<div id="forum_groups">
  <% @messages.each do |message| %>
    <div class="item-group with-avatar">
      <div class="header">
        <%= link_to(message.user_sender.avatar(64), message.user_sender, title: message.user_sender.ign) %>
        <%= render partial: "users/username", locals: { user: message.user_sender } %>
        <%= ago message.created_at %>
        <span style="font-size:18px">
          &nbsp; | &nbsp;
          <b><%= link_to message.subject, messages_path %></b>
        </span>
        <div class="right">
          <%= link_to "Delete message", message, :method => "delete", class: "editlink", data: {confirm: "Delete this message forever?"} %>
        </div>
        <div class="clear-right"></div>
      </div>
      <div class="items">
        <div class="item">
          <%= render_md(truncate message.text, length: 20, omission: "...").html_safe %>
        </div>
      </div>
    </div>
  <% end %>
  <%= paginate @messages %>
</div>
